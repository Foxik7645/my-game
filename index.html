<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Map Game ‚Äî UI Test (full width HUD)</title>

  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=VT323&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>

  <style>
    :root{
      --accent:#ffd56a;
      --xp-filled-top:#d07be0; --xp-filled-bottom:#763d84;
      --xp-empty-top:#5d2f68;  --xp-empty-bottom:#412249;
    }
    html,body{height:100%;margin:0;background:#1e1e1e;color:#eee;font-family:'Segoe UI',sans-serif;}
    .pixel{font-family:'Press Start 2P','VT323',monospace; image-rendering:pixelated;}

    /* –ö–∞—Ä—Ç–∞ */
    #map{position:relative; height:100vh; width:100vw; overflow:hidden;}

    /* –¢–æ—Å—Ç—ã */
    #toasts{position:fixed; right:12px; bottom:12px; display:flex; flex-direction:column; gap:8px; z-index:4000;}
    .toast{background:#2d2b2d; border:1px solid #444; border-radius:10px; padding:10px 12px; box-shadow:0 8px 24px rgba(0,0,0,.35); min-width:280px;}

    /* ================== –ù–ò–ñ–ù–ò–ô HUD ================== */
    #hudRoot{
      position:fixed; left:50%; bottom:12px; transform:translateX(-50%);
      width:96vw; max-width:1700px; pointer-events:none; z-index:3000;
    }

    /* –§–æ–Ω–æ–≤–∞—è –¥–ª–∏–Ω–Ω–∞—è –¥–µ—Ä–µ–≤—è–Ω–Ω–∞—è –ø–ª–∞–Ω–∫–∞ HUD (–ø–æ—á—Ç–∏ –Ω–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω). –õ–µ–∂–∏—Ç –ù–ò–ñ–ï –∫–Ω–æ–ø–æ–∫. */
    #hudBar{
      position:relative; height:128px; width:100%;
      background:url('./images/FinalUi/HUD.png') center/cover no-repeat; /* —Ä–∞—Å—Ç—è–≥–∏–≤–∞–µ–º –∫–∞–∫ —Ñ–æ–Ω */
      image-rendering:pixelated; filter:drop-shadow(0 6px 0 rgba(0,0,0,.35));
      z-index:1; /* –Ω–∏–∂–µ –∫–æ–Ω—Ç—Ä–æ–ª–æ–≤ */
    }
    /* –¢—Ä–µ–∫ —Ñ–∏–æ–ª–µ—Ç–æ–≤–æ–π –ø–æ–ª–æ—Å—ã –≤–Ω—É—Ç—Ä–∏ –±–∞—Ä–∞ (–ø–æ–¥–≥–æ–Ω–∏ —Ü–∏—Ñ–µ—Ä–∫–∏ –ø–æ–¥ —Å–≤–æ–π —Ñ–∞–π–ª) */
    #xpTrack{
      position:absolute; left:10%; right:10%; top:32px; height:32px;
      background:linear-gradient(to bottom,var(--xp-empty-top),var(--xp-empty-bottom));
      overflow:hidden; border-radius:2px;
    }
    #xpFill{
      height:100%; width:0%;
      background:linear-gradient(to bottom,var(--xp-filled-top),var(--xp-filled-bottom));
      transition:width .25s ease;
    }
    /* –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –±–æ–ª—å—à–æ–π –∫—Ä–∏—Å—Ç–∞–ª–ª –ø–æ–≤–µ—Ä—Ö –±–∞—Ä–∞, –Ω–æ –≤—Å—ë –µ—â—ë –Ω–∏–∂–µ –∫–Ω–æ–ø–æ–∫ */
    #crystal{
      position:absolute; left:50%; top:12px; transform:translateX(-50%);
      width:52px; height:84px;
      background:url('./images/FinalUi/Crystal.png') center/contain no-repeat;
      image-rendering:pixelated; pointer-events:none;
    }

    /* –°–ª–æ–π –∫–Ω–æ–ø–æ–∫ –∏ –ø–∞–Ω–µ–ª–µ–π –ø–æ–≤–µ—Ä—Ö –±–∞—Ä–∞ */
    #hudControls{
      position:absolute; inset:0; display:flex; align-items:center; justify-content:space-between;
      padding:0 18px; z-index:2; pointer-events:none; /* –≤–∫–ª—é—á–∏–º –Ω–∞ –∫–Ω–æ–ø–∫–∞—Ö */
    }

    /* –õ–µ–≤–∞—è –¥–µ—Ä–µ–≤—è–Ω–Ω–∞—è –ø–ª–∞—à–∫–∞ ¬´–†–µ—Å—É—Ä—Å—ã¬ª (–µ—Å–ª–∏ –Ω—É–∂–Ω–∞ –∫–∞–∫ –¥–µ–∫–æ—Ä) */
    .leftPlate{
      width:420px; height:88px; pointer-events:none;
      background:url('./images/FinalUi/Botton_Hud.png') left center/contain no-repeat;
      image-rendering:pixelated;
    }

    /* ===== –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –ü–õ–ê–°–¢–ò–ù–ê –∫–Ω–æ–ø–∫–∏ (–µ–¥–∏–Ω—ã–π —Ä–∞–∑–º–µ—Ä –¥–ª—è –≤—Å–µ—Ö) ===== */
    .btn-plate{
      width:220px; height:82px; /* <-- –≤—Å–µ –∫–Ω–æ–ø–∫–∏ —Ç–µ–ø–µ—Ä—å –°–¢–†–û–ì–û –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ */
      background:url('./images/FinalUi/Hud_Botton1.png') center/contain no-repeat;
      image-rendering:pixelated; position:relative; display:flex; align-items:center; justify-content:center;
      filter:drop-shadow(0 3px 0 rgba(0,0,0,.45));
      pointer-events:auto; cursor:pointer; user-select:none;
    }
    .btn-plate:active{ transform:translateY(1px); }

    /* –ò–∫–æ–Ω–∫–∞ –ø–æ–≤–µ—Ä—Ö –ø–ª–∞—Å—Ç–∏–Ω—ã (—Å—Ç—Ä–µ–ª–∫–∞/—à–µ—Å—Ç–µ—Ä—ë–Ω–∫–∞) */
    .btn-icon{
      width:44px; height:44px; background-size:contain; background-repeat:no-repeat; background-position:center;
      image-rendering:pixelated;
    }
    #btnUpgrade .btn-icon{ background-image:url('./images/FinalUi/Icon_Arrow.png'); }
    #btnSettings .btn-icon{ background-image:url('./images/FinalUi/Setting.png'); }

    /* –ö–Ω–æ–ø–∫–∞ –¥–µ–Ω–µ–≥: —Ç–∞ –∂–µ –ø–ª–∞—Å—Ç–∏–Ω–∞ + –¥–æ–ª–ª–∞—Ä + —Ç–µ–∫—Å—Ç */
    #btnMoney{ display:flex; gap:10px; padding:0 12px; }
    #btnMoney .dollar{
      width:36px; height:36px; background:url('./images/FinalUi/Icon_Dollar.png') center/contain no-repeat; image-rendering:pixelated;
    }
    #moneyText{
      color:var(--accent); font-size:18px; line-height:1; text-shadow:0 1px 0 #000, 0 1px 6px rgba(0,0,0,.35);
    }

    /* –¶–µ–Ω—Ç—Ä: –º–æ–∂–µ–º –¥–æ–±–∞–≤–∏—Ç—å –Ω–∞–±–æ—Ä –º–∞–ª–µ–Ω—å–∫–∏—Ö –∫–Ω–æ–ø–æ–∫ –Ω–∞ —Å–∞–º–æ–π –ø–ª–∞–Ω–∫–µ (–ø–æ–∑–∂–µ) */
    .centerSpacer{ flex:1; }

    /* –ê–¥–∞–ø—Ç–∏–≤ */
    @media (max-width: 1480px){ #hudRoot{ transform:translateX(-50%) scale(.95); transform-origin:bottom center; } }
    @media (max-width: 1280px){ #hudRoot{ transform:translateX(-50%) scale(.88); } }
  </style>
</head>
<body>

  <!-- –ö–∞—Ä—Ç–∞ -->
  <div id="map"></div>

  <!-- –ù–ò–ñ–ù–ò–ô HUD -->
  <div id="hudRoot" class="pixel">
    <!-- –§–æ–Ω-–±–∞—Ä (–∑–∞–¥–Ω–∏–π —Å–ª–æ–π) -->
    <div id="hudBar">
      <div id="xpTrack"><div id="xpFill"></div></div>
      <!-- –ü–æ—è–≤–∏—Ç—Å—è, –µ—Å–ª–∏ —Ñ–∞–π–ª Crystal.png –µ—Å—Ç—å -->
      <div id="crystal" aria-hidden="true"></div>
    </div>

    <!-- –ö–æ–Ω—Ç—Ä–æ–ª—ã –ø–æ–≤–µ—Ä—Ö –±–∞—Ä–∞ -->
    <div id="hudControls">
      <div class="leftPlate" aria-hidden="true"></div>

      <div class="centerSpacer"></div>

      <div style="display:flex; gap:14px;">
        <div id="btnMoney" class="btn-plate">
          <div class="dollar" aria-hidden="true"></div>
          <span id="moneyText">$0</span>
        </div>

        <div id="btnUpgrade" class="btn-plate" title="–ú–∞–≥–∞–∑–∏–Ω/–ü–æ—Å—Ç—Ä–æ–π–∫–∞">
          <div class="btn-icon" aria-hidden="true"></div>
        </div>

        <div id="btnSettings" class="btn-plate" title="–ù–∞—Å—Ç—Ä–æ–π–∫–∏">
          <div class="btn-icon" aria-hidden="true"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- –ü—Ä–æ—Å—Ç–æ–π –º–∞–≥–∞–∑–∏–Ω (–¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–ª–∏–∫–∞) -->
  <aside id="shopPanel" class="pixel" style="position:fixed; top:88px; left:0; bottom:0; width:330px; background:#222; border-right:1px solid #3a3a3a; z-index:3500; display:none; overflow-y:auto; padding:12px; box-shadow:8px 0 20px rgba(0,0,0,.35);">
    <div style="display:flex; align-items:center; justify-content:space-between; margin-bottom:10px;">
      <h3>–ú–∞–≥–∞–∑–∏–Ω</h3>
      <button id="shopClose" style="cursor:pointer; background:#444; color:#eee; border:none; padding:6px 10px; border-radius:8px;">√ó</button>
    </div>
    <div class="card" style="position:relative; width:300px; height:438px; margin:10px auto; image-rendering:pixelated; border-radius:12px; box-shadow:0 10px 18px rgba(0,0,0,.35); cursor:pointer; overflow:hidden; background:#2b2b2b;">
      <div class="buybar" style="position:absolute; top:0; left:0; right:0; height:60px; z-index:3; background:linear-gradient(#2b2b2b,#1e1e1e); border-bottom:1px solid #555; display:flex; align-items:center; justify-content:center; gap:10px;">
        <span class="price" style="color:#ffd56a;">100 üí∞</span>
        <button class="pixel" style="background:#444;color:#fff;border:none;border-radius:8px;padding:6px 10px;">–ö—É–ø–∏—Ç—å</button>
      </div>
      <div class="title" style="position:absolute; top:18px; left:16px; right:16px; font-size:13px;">–î–æ–º –¥—Ä–æ–≤–æ—Å–µ–∫–∞</div>
      <div class="desc" style="position:absolute; left:16px; right:16px; bottom:22px; font-size:12px; line-height:1.25;">–†–∞–±–æ—á–∏–µ –¥–æ–±—ã–≤–∞—é—Ç –¥–µ—Ä–µ–≤–æ —Ä—è–¥–æ–º –∏ –Ω–æ—Å—è—Ç –≤ –¥–æ–º.</div>
    </div>
  </aside>

  <div id="toasts"></div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <script type="module">
    /* ===== –û—Ñ—Ñ–ª–∞–π–Ω-–¥–µ–º–æ –ª–æ–≥–∏–∫–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ HUD ===== */
    const resources = { money: 30434 };
    let level = 3, xp = 250; const BASE_XP = 500;
    const $ = (id)=>document.getElementById(id);

    function showToast(text, _, ms=1600){
      const host = $('toasts'); const t = document.createElement('div');
      t.className='toast pixel'; t.textContent=text; host.appendChild(t);
      setTimeout(()=>t.remove(), ms);
    }

    // –ö–∞—Ä—Ç–∞
    await new Promise(r => (document.readyState!=='loading')?r():window.addEventListener('DOMContentLoaded', r, {once:true}));
    const map = L.map('map', { zoomControl:false }).setView([55.751244, 37.618423], 13);
    L.tileLayer('https://cartodb-basemaps-a.global.ssl.fastly.net/dark_nolabels/{z}/{x}/{y}{r}.png',
      { attribution: '¬©OpenStreetMap ¬©Carto', subdomains: 'abcd', maxZoom: 19 }).addTo(map);

    // XP
    const req = lvl => BASE_XP * lvl;
    function renderXP(){
      const p = Math.max(0, Math.min(1, xp / req(level)));
      $('xpFill').style.width = (p*100).toFixed(2)+'%';
    }
    function addXP(a){
      xp += a;
      while (xp >= req(level)){ xp -= req(level); level++; showToast(`üìà –£—Ä–æ–≤–µ–Ω—å ${level}!`); }
      renderXP();
    }

    // –î–µ–Ω—å–≥–∏
    function renderMoney(){
      $('moneyText').textContent = '$' + (resources.money ?? 0).toLocaleString('ru-RU');
    }

    renderMoney(); renderXP();

    // –ö–Ω–æ–ø–∫–∏
    $('btnUpgrade').onclick = () => { const p = document.getElementById('shopPanel'); p.style.display = (p.style.display==='block')?'none':'block'; };
    document.getElementById('shopClose').onclick = () => document.getElementById('shopPanel').style.display='none';
    $('btnSettings').onclick = () => showToast('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–∫–∞ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ üîß');

    // –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è: –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ —Ä–∞—Å—Ç—ë—Ç XP –∏ –¥–µ–Ω—å–≥–∏
    setInterval(()=>{ resources.money+=7; renderMoney(); addXP(22); }, 2000);
  </script>
</body>
</html>
